<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Interactive VR Periodic Table</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
</head>
<body>
    <a-scene vr-mode-ui="enabled: true" background="color: #111">
        <!-- Assets -->
        <a-assets>
            <!-- Шаблон для інтерактивних КУБИКІВ -->
            <a-mixin id="element-box"
                     geometry="primitive: box; width: 1; height: 1; depth: 1"
                     animation__mouseenter="property: scale; to: 1.2 1.2 1.2; startEvents: mouseenter; dur: 200"
                     animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200">
            </a-mixin>
        </a-assets>
        
        <!-- Оточення -->
        <a-sky color="#202020"></a-sky>
        <a-light type="ambient" color="#AAA"></a-light>
        <a-light type="directional" position="-1 1 2" intensity="0.8"></a-light>
        
        <!-- Контейнер для таблиці -->
        <a-entity id="periodic-table-container" position="-9 5 -12" periodic-table-generator>
            <!-- JavaScript створить тут кубики -->
        </a-entity>
        
        <!-- Інформаційна картка (спочатку з привітанням) -->
        <a-entity id="info-card" position="3.5 3.5 -9" visible="true"> <!-- Тепер видима одразу -->
            <!-- Фон картки -->
            <a-plane width="4.5" height="4" color="#222" material="opacity: 0.8"></a-plane>
            
            <!-- Поля для інформації -->
            <a-text id="info-number" value=" " color="#FFF" width="10" align="left" position="-1.8 1.5 0.1"></a-text>
            <a-text id="info-symbol" value="?" color="#FFF" width="20" align="center" position="0 0.5 0.1"></a-text>
            <a-text id="info-name" value="Click an Element" color="#FFF" width="6" align="center" position="0 -0.5 0.1"></a-text>
            <a-text id="info-details" value="Select an element from the table to learn more about it." color="#DDD" width="5" align="left" wrap-count="40" position="-1.8 -1.3 0.1"></a-text>
        </a-entity>
        
        <!-- Камера з курсором -->
        <a-camera position="0 1.6 0">
            <a-cursor raycaster="objects: .clickable"></a-cursor>
        </a-camera>
    </a-scene>
    
    <script>
        // --- РОЗШИРЕНІ ДАНІ ПРО ЕЛЕМЕНТИ ---
        const elementsData = [
            // ... (дані залишаються такими ж, як у попередній версії)
            { number: 1, symbol: 'H', name: 'Hydrogen', mass: 1.008, group: 'nonmetal', x: 0, y: 0, boiling_point_k: 20.28, electron_config: '1s¹' },
            { number: 2, symbol: 'He', name: 'Helium', mass: 4.0026, group: 'noble-gas', x: 17, y: 0, boiling_point_k: 4.22, electron_config: '1s²' },
            { number: 3, symbol: 'Li', name: 'Lithium', mass: 6.94, group: 'alkali-metal', x: 0, y: 1, boiling_point_k: 1615, electron_config: '[He] 2s¹' },
            { number: 4, symbol: 'Be', name: 'Beryllium', mass: 9.0122, group: 'alkaline-earth-metal', x: 1, y: 1, boiling_point_k: 2742, electron_config: '[He] 2s²' },
            { number: 5, symbol: 'B', name: 'Boron', mass: 10.81, group: 'metalloid', x: 12, y: 1, boiling_point_k: 4200, electron_config: '[He] 2s² 2p¹' },
            { number: 6, symbol: 'C', name: 'Carbon', mass: 12.011, group: 'nonmetal', x: 13, y: 1, boiling_point_k: 5100, electron_config: '[He] 2s² 2p²' },
            { number: 7, symbol: 'N', name: 'Nitrogen', mass: 14.007, group: 'nonmetal', x: 14, y: 1, boiling_point_k: 77.36, electron_config: '[He] 2s² 2p³' },
            { number: 8, symbol: 'O', name: 'Oxygen', mass: 15.999, group: 'nonmetal', x: 15, y: 1, boiling_point_k: 90.20, electron_config: '[He] 2s² 2p⁴' },
            { number: 9, symbol: 'F', name: 'Fluorine', mass: 18.998, group: 'halogen', x: 16, y: 1, boiling_point_k: 85.03, electron_config: '[He] 2s² 2p⁵' },
            { number: 10, symbol: 'Ne', name: 'Neon', mass: 20.180, group: 'noble-gas', x: 17, y: 1, boiling_point_k: 27.07, electron_config: '[He] 2s² 2p⁶' },
            { number: 11, symbol: 'Na', name: 'Sodium', mass: 22.990, group: 'alkali-metal', x: 0, y: 2, boiling_point_k: 1156, electron_config: '[Ne] 3s¹' },
            { number: 12, symbol: 'Mg', name: 'Magnesium', mass: 24.305, group: 'alkaline-earth-metal', x: 1, y: 2, boiling_point_k: 1363, electron_config: '[Ne] 3s²' },
            { number: 13, symbol: 'Al', name: 'Aluminum', mass: 26.982, group: 'post-transition-metal', x: 12, y: 2, boiling_point_k: 2792, electron_config: '[Ne] 3s² 3p¹' },
            { number: 14, symbol: 'Si', name: 'Silicon', mass: 28.085, group: 'metalloid', x: 13, y: 2, boiling_point_k: 3538, electron_config: '[Ne] 3s² 3p²' },
            { number: 15, symbol: 'P', name: 'Phosphorus', mass: 30.974, group: 'nonmetal', x: 14, y: 2, boiling_point_k: 550, electron_config: '[Ne] 3s² 3p³' },
            { number: 16, symbol: 'S', name: 'Sulfur', mass: 32.06, group: 'nonmetal', x: 15, y: 2, boiling_point_k: 717.8, electron_config: '[Ne] 3s² 3p⁴' },
            { number: 17, symbol: 'Cl', name: 'Chlorine', mass: 35.45, group: 'halogen', x: 16, y: 2, boiling_point_k: 239.11, electron_config: '[Ne] 3s² 3p⁵' },
            { number: 18, symbol: 'Ar', name: 'Argon', mass: 39.948, group: 'noble-gas', x: 17, y: 2, boiling_point_k: 87.30, electron_config: '[Ne] 3s² 3p⁶' }
        ];

        const groupColors = {
            'nonmetal': '#90EE90',
            'noble-gas': '#C8A2C8',
            'alkali-metal': '#FF6347',
            'alkaline-earth-metal': '#FFD700',
            'metalloid': '#A52A2A',
            'halogen': '#40E0D0',
            'post-transition-metal': '#B0C4DE'
        };
        
        AFRAME.registerComponent('periodic-table-generator', {
            init: function() {
                const tableContainer = this.el;

                elementsData.forEach(elementData => {
                    // Створюємо КУБИК
                    const box = document.createElement('a-entity');
                    box.setAttribute('mixin', 'element-box'); // Використовуємо шаблон для кубиків
                    box.classList.add('clickable');

                    const xPos = elementData.x * 1.2;
                    const yPos = -elementData.y * 1.2;
                    box.setAttribute('position', `${xPos} ${yPos} 0`);
                    
                    box.setAttribute('material', 'color', groupColors[elementData.group] || '#FFF');
                    
                    // Зберігаємо дані в самому об'єкті
                    box.dataset.elementInfo = JSON.stringify(elementData);

                    // Додаємо текст-символ
                    const symbolText = document.createElement('a-text');
                    symbolText.setAttribute('value', elementData.symbol);
                    symbolText.setAttribute('align', 'center');
                    symbolText.setAttribute('position', '0 0 0.6'); // Трохи попереду кубика
                    symbolText.setAttribute('color', '#000');
                    symbolText.setAttribute('width', 4);
                    box.appendChild(symbolText);
                    
                    tableContainer.appendChild(box);
                });

                // ==========================================================
                // НОВА ЛОГІКА: ОНОВЛЕННЯ КАРТКИ ПО КЛІКУ
                // ==========================================================
                // Функція для оновлення картки
                function updateInfoCard(elementData) {
                    // Отримуємо доступ до елементів картки
                    const infoNumber = document.getElementById('info-number');
                    const infoSymbol = document.getElementById('info-symbol');
                    const infoName = document.getElementById('info-name');
                    const infoDetails = document.getElementById('info-details');
                    
                    // Оновлюємо інформацію
                    infoNumber.setAttribute('value', elementData.number);
                    infoSymbol.setAttribute('value', elementData.symbol);
                    infoName.setAttribute('value', elementData.name);
                    
                    const tempCelsius = (elementData.boiling_point_k - 273.15).toFixed(2);
                    
                    const detailsText = 
                        `Atomic Mass: ${elementData.mass}\n` +
                        `Group: ${elementData.group.replace(/-/g, ' ')}\n\n` +
                        `Boiling Point: ${elementData.boiling_point_k} K / ${tempCelsius} °C\n\n` +
                        `Electron Config: ${elementData.electron_config}`;
                    
                    infoDetails.setAttribute('value', detailsText);
                }

                // Слухаємо кліки по всій сцені
                this.el.sceneEl.addEventListener('click', function(event) {
                    // Перевіряємо, чи клікнули на об'єкт з класом clickable
                    if (event.target.classList.contains('clickable')) {
                        const info = JSON.parse(event.target.dataset.elementInfo);
                        updateInfoCard(info);
                    }
                });
            }
        });
    </script>
</body>
</html>
